language: php

php: 
  - 5.3
  #- 5.4
  #- 5.5
  #- 5.6  
  
env:
  #- secure: Cl9e5akLjt3kpM/czbS+c5VIqKOyiJmGuGiObRp/cDF0yedw5++lDapYyiCW5GggJ3Pxe7FEG7jwnfADpdV8AozUO8EVO6w2hHtK/651t2Cc/McLLDGPbatqIGjRXuLcN8uKBTnxe0an1Wmg1ep6vUfh88sdvzyKBGpXzAiPEUgKBWLsgXnrHaRC7LAuMEBO4JxWFkeoUVTXvsio1OcFtIqasQMBEj11k90NC5TwkoSQq3rRpHwWIBoJnDbCFwyuHomTA13vci2k3Hg/hBhl3YKd6UtZkOSe+mQjtBqYMF9AAIeM6NLen9SOsAdn85KgeI6O7vK1yaVPan79X5Pdrg==
  - BOO=TEST
  
build:
  ci:
    - mkdir -p shippable/codecoverage
    - mkdir -p shippable/testresults   
    - phpunit  --log-junit shippable/testresults/junit.xml --coverage-xml shippable/codecoverage tests/calculator_test.php
    
integrations:    
  notifications:
    - integrationName: notify-slack 
      type: slack
      recipients:
        - "#random" 
        - "#rc-public" 
        - "#rc-private"
      on_start: always
      on_success: change
      on_failure: change 
      on_cancel: change
       
    - integrationName: email         
      type: email        
      recipients:  
        - shiptest.rc.ow@gmail.com
        - shiptest.rc.me@gmail.com
     # sendConsoleLogs : true
     # sendCoverageReports : true
      on_start: always
      on_success: change
      on_failure: change
      on_cancel: change
     
    - integrationName: irc  
      type: irc
      recipients:
        - "chat.freenode.net#test-rc"
        - "webchat.irchighway.net#test-rc"
      on_start: always
      on_success: change  
      on_failure: change
      on_cancel: change
    
    - integrationName: notify-hipchat
      type: hipchat
      recipients: 
        - '#rc-private'
        - '#rc-public'
        - '@shiptestrcow'
      on_start: always
      on_success: change
      on_failure: change
      on_cancel: change
     
    - integrationName: generic-webhook   #issue will get created in github samleNod project
      type: webhook
      payload:
        - title=Failure - $REPO_FULL_NAME - $BUILD_NUMBER
        - body=Shippable Run $BUILD_NUMBER ($BUILD_URL) failed for $COMPARE_URL 
      on_start: always
      on_success: change
      on_failure: change 
      on_cancel: change
      
    - integrationName: project-trigger #samplNod project in shiptest-rc-ow will trigger
      type: webhook
      payload:
       # - BUILD_NUM=$SHIPPABLE_JOB_NUMBER 
        - BUILD_NUM=$SHIPPABLE_BUILD_NUMBER
        - FOO=FUBU
        - GOO=GUBU
      on_start: always
      on_success: change
      on_failure: change
      on_cancel: change
      
    - integrationName: resource-trigger
      type: webhook
      payload:
        - versionName=Shippable Run $BUILD_NUMBER 
      on_start: always
      on_success: change
      on_failure: change
      on_cancel: change      
